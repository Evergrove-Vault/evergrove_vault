---
tags:
  - Технология
  - Инструмент
  - CLI
---

# Информация о технологии
## Область применения

Используется для:
- контроля версий больших датасетов 
- реализации воспроизводимых пайплайнов обработки данных
- интеграции внешних хранилищ данных
### Аналоги, схожие продукты
Если речь идет об удобстве работы с большими файлами, то DVC одно из удобнейших решений, но с точки зрения ведения экспериментов и анализа результатов лучше присмотреться к этим альтернативам:
- [[Wandb|wandb]]
- [[ClearML]]
- [[MLflow]]

## Описание возможностей
### Принцип работы

**DVC** работает «поверх» Git, позволяя версионировать не только исходный код, но и большие файлы данных и модели. Вместо того чтобы хранить сами данные в Git, DVC создаёт небольшие метафайлы (с расширением .dvc), которые содержат контрольные суммы (например, MD5) и ссылки на данные, находящиеся в кэше и/или удалённом хранилище. Это позволяет избежать перегрузки репозитория Git большими файлами, при этом сохраняя историю изменений и возможность отката к любым версиям данных и моделей.
### Возможности

- **Автоматизация этапов обработки:**  
    С помощью DVC можно разбить процесс подготовки данных, обучения и оценки моделей на отдельные этапы (стадии), каждый из которых описывается в файлах конфигурации (dvc.yaml и dvc.lock). Это позволяет отслеживать зависимости между этапами и автоматически пересчитывать только те части пайплайна, где произошли изменения.  
    [habr.com](https://habr.com/ru/companies/raiffeisenbank/articles/461803/)
    [habr.com](https://habr.com/ru/articles/776014/)
    
- **Упрощение экспериментов:**  
    При внесении изменений в данные или код DVC анализирует, какие стадии пайплайна необходимо пересчитать, что делает процесс экспериментов быстрым и удобным. Также можно использовать команды для запуска экспериментов с различными параметрами, сравнения результатов (например, по метрикам) и сохранения лучшего варианта.
## Материалы

 [Официальная документация](https://dvc.org/doc/start)

>[!seealso]
>#cтатьи
>- [Туториал Habr](https://habr.com/ru/articles/761072/)
>- [Туториал_2 Habr](https://habr.com/ru/companies/raiffeisenbank/articles/461803/)
>---
>#видео
> - [Лекция от ODS](https://www.youtube.com/watch?v=MhYicUx0-gA)
> - [Про версионирование моделей и сбор метрик](https://www.youtube.com/watch?v=u4jmernq9Ak) 

# Настройка  
## Как установить

```bash 
pip install dvc[all] # в зависимости от места хронения разные пакеты [s3], [gdrive] 
```

## Подключение GDrive 

[Гайд по подключению](https://dvc.org/doc/user-guide/data-management/remote-storage/google-drive)
# Рекомендации по работе

## Добавление больших файлов в DVC:

После установки и инициализации (dvc init) файлы можно добавить следующим образом:
``` bash
	dvc add data.csv
	git add data.csv.dvc .gitignore
	git commit -m ""
            ```
    
**dvc add** создает .dvc-файл, а сам оригинальный файл остается в локальном хранилище или удаляется (если включен dvc cache)

**git add .gitignore** нужен, потому что DVC автоматически добавляет в .gitignore все файлы, которые не должны попадать в Git

Иными словами, команда dvc add создает файл <имя_файла>.dvc, который хранит ссылку на данные. Сам файл остается в локальном кэше или удаленном хранилище, а .gitignore исключает его из Git, чтобы не перегружать репозиторий.

## Для загрузки в удаленное хранилище настраивается путь:

- Для локального хранилища:
```bash
	dvc remote add myremote /mnt/data/dvcstore
	dvc remote default myremote
```

- Для google drive (dvc[gdrive]) или s3 (dvc[s3]):
	``` bash
	dvc remote add myremote gdrive://<folder-id>            
	dvc remote add myremote s3://mybucket/dvcstore
	```

## Для сохранения изменений:

``` bash
dvc push
git push
```

## Как восстанавливать данные после клонирования репозитория с DVC-данными:

``` bash
git clone <repo-url>
dvc pull
```

**dvc pull** подтягивает только последнюю версию. Если нужен полный контроль над версиями, можно использовать dvc checkout <версия> для восстановления конкретной версии данных (после переключения на нужный коммит в Git)

## Как переключиться на состояние данных привязанных к конкретному коммиту

```bash 
git checkout # переходим в нужный нам коммит 
dvc checkout # приводим состояние данных в актуальное 
```